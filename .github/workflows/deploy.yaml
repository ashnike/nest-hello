name: Deploy to EC2

on:
  workflow_run:
    workflows: ["CI"]
    types:
      - completed

jobs:
  deploy:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: [self-hosted, ip-10-0-4-135] 

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Deploy Dockerized Application
      run: |
        docker-compose down
        docker-compose up -d --build
